<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Quant - Intelligent Hedge Fund Partner</title>
    <!-- Vue 3 -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <!-- Axios -->
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Phosphor Icons -->
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    
    <style>
        :root {
            --bg-global: #0B0E11;
            --bg-panel: #151A21;
            --primary: #00F0FF;
            --primary-dim: rgba(0, 240, 255, 0.1);
            --secondary: #2D6BFF;
            --success: #00D68F;
            --danger: #FF4D4D;
            --warning: #FFC107;
            --text-main: #FFFFFF;
            --text-sec: #8B949E;
            --border: #2C3036;
            --font-ui: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            --font-mono: "JetBrains Mono", Consolas, monospace;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            background-color: var(--bg-global);
            color: var(--text-main);
            font-family: var(--font-ui);
            height: 100vh;
            display: flex;
            overflow: hidden;
        }

        /* Sidebar */
        .sidebar {
            width: 240px;
            background-color: var(--bg-panel);
            border-right: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            padding: 20px;
            flex-shrink: 0;
        }

        .logo {
            font-size: 20px;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 40px;
            display: flex;
            align-items: center;
            gap: 10px;
            letter-spacing: -0.5px;
        }
        
        .logo span { color: white; }

        .nav-item {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            color: var(--text-sec);
            text-decoration: none;
            border-radius: 8px;
            margin-bottom: 8px;
            transition: all 0.2s;
            cursor: pointer;
            font-size: 14px;
        }

        .nav-item:hover, .nav-item.active {
            background-color: var(--primary-dim);
            color: var(--primary);
        }

        .nav-item i { font-size: 18px; margin-right: 12px; }

        /* Main Content */
        .main {
            flex: 1;
            display: flex;
            flex-direction: column;
            position: relative;
            min-width: 0;
        }

        /* Top Bar */
        .top-bar {
            height: 60px;
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 24px;
            background: var(--bg-global);
        }

        .market-ticker {
            display: flex;
            gap: 24px;
            font-family: var(--font-mono);
            font-size: 12px;
            color: var(--text-sec);
        }

        .ticker-item { display: flex; gap: 8px; }
        .ticker-item span.up { color: var(--success); }
        .ticker-item span.down { color: var(--danger); }

        /* Workspace */
        .workspace {
            flex: 1;
            padding: 24px;
            overflow-y: auto;
            position: relative;
        }

        /* Components */
        .btn {
            background: var(--primary);
            color: #000;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 13px;
        }
        .btn:hover { opacity: 0.9; transform: translateY(-1px); }
        .btn:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }
        .btn-secondary { background: var(--secondary); color: white; }
        
        .card {
            background-color: var(--bg-panel);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 20px;
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        .card-header {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-sec);
            margin-bottom: 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        /* Dashboard */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .stat-card {
            background: var(--bg-panel);
            border: 1px solid var(--border);
            padding: 20px;
            border-radius: 12px;
        }
        
        .stat-title { font-size: 12px; color: var(--text-sec); margin-bottom: 8px; }
        .stat-value { font-size: 24px; font-weight: 600; font-family: var(--font-mono); }
        .stat-change { font-size: 12px; margin-top: 4px; display: flex; align-items: center; gap: 4px; }
        .text-up { color: var(--success); }
        .text-down { color: var(--danger); }

        /* Strategy Lab (Split View) */
        .strategy-lab {
            display: flex;
            height: 100%;
            gap: 20px;
        }

        .chat-panel {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: var(--bg-panel);
            border: 1px solid var(--border);
            border-radius: 12px;
            overflow: hidden;
        }

        .chat-history {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .chat-message {
            max-width: 85%;
            padding: 12px 16px;
            border-radius: 12px;
            font-size: 14px;
            line-height: 1.5;
        }

        .chat-user {
            align-self: flex-end;
            background: var(--secondary);
            color: white;
            border-bottom-right-radius: 4px;
        }

        .chat-ai {
            align-self: flex-start;
            background: rgba(255, 255, 255, 0.05);
            border-bottom-left-radius: 4px;
        }

        .chat-input-area {
            padding: 16px;
            border-top: 1px solid var(--border);
            display: flex;
            gap: 10px;
        }

        .chat-input {
            flex: 1;
            background: rgba(0, 0, 0, 0.2);
            border: 1px solid var(--border);
            color: white;
            padding: 10px 14px;
            border-radius: 8px;
            outline: none;
            font-family: var(--font-ui);
        }
        .chat-input:focus { border-color: var(--primary); }

        .code-panel {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: var(--bg-panel);
            border: 1px solid var(--border);
            border-radius: 12px;
            overflow: hidden;
        }

        .code-editor {
            flex: 1;
            background: #0d1117;
            color: #c9d1d9;
            font-family: var(--font-mono);
            font-size: 13px;
            padding: 16px;
            border: none;
            resize: none;
            outline: none;
            line-height: 1.5;
        }

        /* Backtest */
        .backtest-layout {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 20px;
            height: 100%;
        }

        .config-panel {
            background: var(--bg-panel);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 20px;
            overflow-y: auto;
        }

        .form-group { margin-bottom: 20px; }
        .form-label { display: block; font-size: 12px; color: var(--text-sec); margin-bottom: 8px; }
        .form-control {
            width: 100%;
            background: rgba(0,0,0,0.2);
            border: 1px solid var(--border);
            color: white;
            padding: 10px;
            border-radius: 6px;
            font-family: var(--font-mono);
            font-size: 13px;
        }
        .form-control:focus { border-color: var(--primary); outline: none; }

        .results-panel {
            display: flex;
            flex-direction: column;
            gap: 20px;
            overflow-y: auto;
        }

        .chart-container {
            background: var(--bg-panel);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 20px;
            height: 400px;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
        }

        /* Loading */
        .loading-overlay {
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(11, 14, 17, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10;
            backdrop-filter: blur(4px);
        }
        .spinner {
            width: 40px; height: 40px;
            border: 3px solid rgba(0, 240, 255, 0.1);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        @keyframes spin { to { transform: rotate(360deg); } }

        /* Utils */
        .flex-spacer { flex: 1; }
        .fade-enter-active, .fade-leave-active { transition: opacity 0.3s; }
        .fade-enter-from, .fade-leave-to { opacity: 0; }
    </style>
</head>
<body>
    <div id="app">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="logo">
                <i class="ph ph-chart-polar"></i>
                <span>AI Quant</span>
            </div>
            
            <nav>
                <div class="nav-item" :class="{ active: currentTab === 'dashboard' }" @click="currentTab = 'dashboard'">
                    <i class="ph ph-squares-four"></i> Dashboard
                </div>
                <div class="nav-item" :class="{ active: currentTab === 'strategy' }" @click="currentTab = 'strategy'">
                    <i class="ph ph-brain"></i> Strategy Lab
                </div>
                <div class="nav-item" :class="{ active: currentTab === 'backtest' }" @click="currentTab = 'backtest'">
                    <i class="ph ph-clock-counter-clockwise"></i> Time Machine
                </div>
                <div class="nav-item" :class="{ active: currentTab === 'market' }" @click="currentTab = 'market'">
                    <i class="ph ph-globe-hemisphere-west"></i> Market Radar
                </div>
                <div class="nav-item" :class="{ active: currentTab === 'settings' }" @click="currentTab = 'settings'">
                    <i class="ph ph-gear"></i> Settings
                </div>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main">
            <!-- Top Bar -->
            <header class="top-bar">
                <div class="market-ticker">
                    <div class="ticker-item"><span>SH000001</span><span class="up">+0.54%</span></div>
                    <div class="ticker-item"><span>SZ399001</span><span class="down">-0.21%</span></div>
                    <div class="ticker-item"><span>BTC/USD</span><span class="up">+1.24%</span></div>
                    <div class="ticker-item"><span>XAU/USD</span><span class="up">+0.88%</span></div>
                </div>
                <div class="user-profile">
                    <button class="btn btn-outline" style="background: transparent; border: 1px solid var(--border); color: var(--text-sec);">
                        <i class="ph ph-user"></i> Admin
                    </button>
                </div>
            </header>

            <!-- Workspace -->
            <div class="workspace">
                
                <!-- Dashboard Tab -->
                <div v-if="currentTab === 'dashboard'" class="page">
                    <div class="dashboard-grid">
                        <div class="stat-card">
                            <div class="stat-title">Total Equity</div>
                            <div class="stat-value">Â¥1,245,000</div>
                            <div class="stat-change text-up"><i class="ph ph-trend-up"></i> +12.5%</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-title">Active Strategies</div>
                            <div class="stat-value">3</div>
                            <div class="stat-change"><span style="color: var(--text-sec)">Running</span></div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-title">Win Rate (Avg)</div>
                            <div class="stat-value">{{ dashboardStats.win_rate_avg ? dashboardStats.win_rate_avg.toFixed(1) : 0 }}%</div>
                            <div class="stat-change text-up">High</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-title">Max Drawdown</div>
                            <div class="stat-value">{{ dashboardStats.avg_drawdown ? dashboardStats.avg_drawdown.toFixed(1) : 0 }}%</div>
                            <div class="stat-change text-down">Moderate</div>
                        </div>
                    </div>

                    <div class="card" style="height: 400px;">
                        <div class="card-header">
                            <span>Strategy Performance Distribution</span>
                            <i class="ph ph-dots-three"></i>
                        </div>
                        <div style="flex: 1; position: relative;">
                            <canvas id="dashboardChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Strategy Lab Tab -->
                <div v-if="currentTab === 'strategy'" class="strategy-lab">
                    <!-- Left: Chat -->
                    <div class="chat-panel">
                        <div class="card-header" style="padding: 16px; border-bottom: 1px solid var(--border); margin: 0;">
                            <span>AI Strategy Architect</span>
                        </div>
                        <div class="chat-history" ref="chatHistory">
                            <div v-for="(msg, index) in strategyChat" :key="index" 
                                 class="chat-message" 
                                 :class="msg.role === 'user' ? 'chat-user' : 'chat-ai'">
                                {{ msg.content }}
                            </div>
                            <div v-if="isGenerating" class="chat-message chat-ai">
                                <i class="ph ph-spinner" style="animation: spin 1s infinite linear;"></i> Thinking...
                            </div>
                        </div>
                        <div class="chat-input-area">
                            <input v-model="chatInput" @keyup.enter="sendMessage" 
                                   type="text" class="chat-input" 
                                   placeholder="Describe your strategy (e.g., 'Buy when MA20 crosses above MA60...')">
                            <button @click="sendMessage" class="btn" :disabled="isGenerating || !chatInput">
                                <i class="ph ph-paper-plane-right"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Right: Code -->
                    <div class="code-panel">
                        <div class="card-header" style="padding: 16px; border-bottom: 1px solid var(--border); margin: 0;">
                            <span>Generated Strategy Code</span>
                            <div style="display: flex; gap: 8px;">
                                <button class="btn btn-secondary" @click="copyCode">Copy</button>
                                <button class="btn" @click="deployToBacktest">Test Strategy</button>
                            </div>
                        </div>
                        <textarea v-model="strategyCode" class="code-editor" spellcheck="false"></textarea>
                    </div>
                </div>

                <!-- Backtest Tab -->
                <div v-if="currentTab === 'backtest'" class="backtest-layout">
                    <!-- Config -->
                    <div class="config-panel">
                        <div class="card-header">Backtest Configuration</div>
                        
                        <div class="form-group">
                            <label class="form-label">Strategy Code (Paste Here)</label>
                            <textarea v-model="backtestConfig.strategy_code" class="form-control" style="height: 100px; font-size: 11px;"></textarea>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Symbol</label>
                            <input v-model="backtestConfig.symbol" type="text" class="form-control" placeholder="e.g. SH000001">
                        </div>

                        <div class="form-group">
                            <label class="form-label">Period</label>
                            <select v-model="backtestConfig.period" class="form-control">
                                <option value="1d">Daily (1d)</option>
                                <option value="60m">60 Minutes</option>
                                <option value="30m">30 Minutes</option>
                                <option value="15m">15 Minutes</option>
                                <option value="5m">5 Minutes</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Date Range</label>
                            <div style="display: flex; gap: 8px;">
                                <input v-model="backtestConfig.start_date" type="date" class="form-control">
                                <input v-model="backtestConfig.end_date" type="date" class="form-control">
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Initial Cash</label>
                            <input v-model="backtestConfig.initial_cash" type="number" class="form-control">
                        </div>

                        <button @click="runBacktest" class="btn" style="width: 100%;" :disabled="isBacktesting">
                            {{ isBacktesting ? 'Running Simulation...' : 'Start Backtest' }}
                        </button>
                    </div>

                    <!-- Results -->
                    <div class="results-panel">
                        <!-- Metrics -->
                        <div class="metrics-grid">
                            <div class="stat-card">
                                <div class="stat-title">Total Return</div>
                                <div class="stat-value" :class="getReturnClass(backtestResult?.return_rate)">
                                    {{ backtestResult?.return_rate?.toFixed(2) || 0 }}%
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-title">Sharpe Ratio</div>
                                <div class="stat-value">{{ backtestResult?.sharpe_ratio?.toFixed(2) || 0 }}</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-title">Max Drawdown</div>
                                <div class="stat-value text-down">{{ backtestResult?.max_drawdown?.toFixed(2) || 0 }}%</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-title">Win Rate</div>
                                <div class="stat-value">{{ backtestResult?.win_rate?.toFixed(1) || 0 }}%</div>
                            </div>
                        </div>

                        <!-- Chart -->
                        <div class="chart-container" style="position: relative;">
                            <div v-if="isBacktesting" class="loading-overlay">
                                <div class="spinner"></div>
                            </div>
                            <canvas id="backtestChart"></canvas>
                        </div>

                        <!-- Logs -->
                        <div class="card" style="flex: 1; min-height: 200px;">
                            <div class="card-header">Trade Logs</div>
                            <div style="overflow-y: auto; font-family: var(--font-mono); font-size: 12px; color: var(--text-sec);">
                                <div v-for="(log, idx) in backtestLogs" :key="idx" style="padding: 4px 0; border-bottom: 1px solid rgba(255,255,255,0.05);">
                                    {{ log }}
                                </div>
                                <div v-if="backtestLogs.length === 0" style="padding: 20px; text-align: center;">No trades recorded</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Market Radar Tab -->
                <div v-if="currentTab === 'market'" class="page" style="display: flex; align-items: center; justify-content: center; height: 100%;">
                    <div style="text-align: center; color: var(--text-sec);">
                        <i class="ph ph-globe-hemisphere-west" style="font-size: 64px; margin-bottom: 20px; opacity: 0.5;"></i>
                        <h2>Market Radar</h2>
                        <p>Real-time sentiment analysis and anomaly detection coming soon.</p>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        const { createApp, ref, reactive, onMounted, nextTick, computed } = Vue;

        createApp({
            setup() {
                const currentTab = ref('dashboard');
                const isGenerating = ref(false);
                const isBacktesting = ref(false);
                const chartInstance = ref(null);
                const dashboardChartInstance = ref(null);

                // --- Dashboard State ---
                const dashboardStats = ref({});

                // --- Strategy Lab State ---
                const chatInput = ref('');
                const strategyCode = ref('');
                const strategyChat = ref([
                    { role: 'ai', content: 'Hello! I am your AI Quant Architect. Describe a trading idea, and I will build the strategy code for you.' }
                ]);
                const chatHistory = ref(null);

                // --- Backtest State ---
                const backtestConfig = reactive({
                    symbol: 'SH000001',
                    period: '1d',
                    start_date: '2023-01-01',
                    end_date: '2023-12-31',
                    initial_cash: 1000000,
                    strategy_code: '', // Can be pasted or filled from Strategy Lab
                    strategy_params: {},
                    auto_optimize: false
                });
                const backtestResult = ref(null);
                const backtestLogs = ref([]);

                // API Config
                const api = axios.create({
                    baseURL: 'http://localhost:8001/api'
                });

                // --- Methods ---

                // 1. Dashboard
                const loadDashboardStats = async () => {
                    try {
                        const res = await api.get('/backtest/stats');
                        dashboardStats.value = res.data;
                        renderDashboardChart(res.data.return_distribution || {});
                    } catch (e) {
                        console.error("Failed to load stats", e);
                    }
                };

                const renderDashboardChart = (dist) => {
                    const ctx = document.getElementById('dashboardChart');
                    if (!ctx) return;
                    
                    if (dashboardChartInstance.value) dashboardChartInstance.value.destroy();

                    dashboardChartInstance.value = new Chart(ctx, {
                        type: 'bar',
                        data: {
                            labels: Object.keys(dist),
                            datasets: [{
                                label: 'Strategy Count',
                                data: Object.values(dist),
                                backgroundColor: 'rgba(0, 240, 255, 0.5)',
                                borderColor: '#00F0FF',
                                borderWidth: 1
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: { legend: { display: false } },
                            scales: {
                                y: { grid: { color: 'rgba(255,255,255,0.05)' } },
                                x: { grid: { display: false } }
                            }
                        }
                    });
                };

                // 2. Strategy Lab
                const sendMessage = async () => {
                    if (!chatInput.value.trim()) return;

                    const userText = chatInput.value;
                    strategyChat.value.push({ role: 'user', content: userText });
                    chatInput.value = '';
                    isGenerating.value = true;
                    scrollToBottom();

                    try {
                        // Call Real API
                        const res = await api.post('/strategies/generate', { text: userText });
                        
                        const aiResponse = "I've generated a strategy based on your description. You can see the code in the editor panel.";
                        strategyChat.value.push({ role: 'ai', content: aiResponse });
                        
                        if (res.data && res.data.code) {
                            strategyCode.value = res.data.code;
                            // Also update backtest config params if available
                            if (res.data.config) {
                                backtestConfig.strategy_params = res.data.config;
                            }
                        }
                    } catch (e) {
                        strategyChat.value.push({ role: 'ai', content: "Sorry, I encountered an error generating the strategy. Please try again." });
                        console.error(e);
                    } finally {
                        isGenerating.value = false;
                        scrollToBottom();
                    }
                };

                const scrollToBottom = () => {
                    nextTick(() => {
                        if (chatHistory.value) chatHistory.value.scrollTop = chatHistory.value.scrollHeight;
                    });
                };

                const deployToBacktest = () => {
                    backtestConfig.strategy_code = strategyCode.value;
                    currentTab.value = 'backtest';
                };
                
                const copyCode = () => {
                    navigator.clipboard.writeText(strategyCode.value);
                    alert("Code copied to clipboard!");
                };

                // 3. Backtest
                const runBacktest = async () => {
                    isBacktesting.value = true;
                    backtestResult.value = null;
                    backtestLogs.value = [];
                    
                    try {
                        // Construct payload
                        const payload = {
                            ...backtestConfig,
                            initial_cash: parseFloat(backtestConfig.initial_cash)
                        };

                        const res = await api.post('/backtest', payload);
                        backtestResult.value = res.data;
                        
                        // Parse logs if available
                        if (res.data.logs) {
                            // Logs might be a long string or array
                            backtestLogs.value = Array.isArray(res.data.logs) ? res.data.logs : res.data.logs.split('\n');
                        }

                        // Render Chart
                        renderBacktestChart(res.data.equity_curve);

                    } catch (e) {
                        console.error(e);
                        alert("Backtest failed: " + (e.response?.data?.detail || e.message));
                    } finally {
                        isBacktesting.value = false;
                    }
                };

                const renderBacktestChart = (equityCurve) => {
                    const ctx = document.getElementById('backtestChart');
                    if (!ctx) return;
                    
                    if (chartInstance.value) chartInstance.value.destroy();

                    // Parse equity curve data
                    // Assuming format: [{date: '...', value: 1000}, ...] or similar
                    let labels = [];
                    let data = [];
                    
                    if (Array.isArray(equityCurve)) {
                        equityCurve.forEach(pt => {
                            labels.push(pt.date);
                            data.push(pt.total_value || pt.value);
                        });
                    }

                    chartInstance.value = new Chart(ctx, {
                        type: 'line',
                        data: {
                            labels: labels,
                            datasets: [{
                                label: 'Equity Curve',
                                data: data,
                                borderColor: '#00F0FF',
                                backgroundColor: 'rgba(0, 240, 255, 0.1)',
                                borderWidth: 2,
                                fill: true,
                                tension: 0.1,
                                pointRadius: 0
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            interaction: {
                                intersect: false,
                                mode: 'index',
                            },
                            scales: {
                                y: {
                                    grid: { color: 'rgba(255,255,255,0.05)' },
                                    ticks: { color: '#8B949E' }
                                },
                                x: {
                                    grid: { display: false },
                                    ticks: { color: '#8B949E', maxTicksLimit: 10 }
                                }
                            },
                            plugins: {
                                legend: { display: false },
                                tooltip: {
                                    backgroundColor: 'rgba(21, 26, 33, 0.9)',
                                    titleColor: '#fff',
                                    bodyColor: '#00F0FF',
                                    borderColor: '#2C3036',
                                    borderWidth: 1
                                }
                            }
                        }
                    });
                };

                const getReturnClass = (val) => {
                    if (!val) return '';
                    return val > 0 ? 'text-up' : (val < 0 ? 'text-down' : '');
                };

                // Lifecycle
                onMounted(() => {
                    loadDashboardStats();
                });

                return {
                    currentTab,
                    // Dashboard
                    dashboardStats,
                    // Strategy
                    strategyChat,
                    chatInput,
                    strategyCode,
                    isGenerating,
                    chatHistory,
                    sendMessage,
                    deployToBacktest,
                    copyCode,
                    // Backtest
                    backtestConfig,
                    backtestResult,
                    backtestLogs,
                    isBacktesting,
                    runBacktest,
                    getReturnClass
                };
            }
        }).mount('#app');
    </script>
</body>
</html>
